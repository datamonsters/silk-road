(function(e){function t(t){for(var n,o,i=t[0],c=t[1],u=t[2],l=0,p=[];l<i.length;l++)o=i[l],r[o]&&p.push(r[o][0]),r[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);f&&f(t);while(p.length)p.shift()();return s.push.apply(s,u||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,i=1;i<a.length;i++){var c=a[i];0!==r[c]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={app:0},s=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var f=c;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("c21b"),r=a.n(n);r.a},"11a7":function(e,t,a){"use strict";var n=a("1f45"),r=a.n(n);r.a},"1f45":function(e,t,a){},"2c71":function(e,t,a){},"4dd1":function(e,t,a){"use strict";var n=a("57c1"),r=a.n(n);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("097d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},s=[],o=(a("034f"),a("2877")),i={},c=Object(o["a"])(i,r,s,!1,null,null,null);c.options.__file="App.vue";var u=c.exports,f=a("8c4f"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-layout",{attrs:{view:"lHh Lpr lFf"}},[a("q-layout-header",[a("q-toolbar",{attrs:{color:"primary",glossy:"mat"===e.$q.theme,inverted:"ios"===e.$q.theme}},[a("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Menu",icon:"mdi-menu"},on:{click:function(t){e.$f.vars.openDrawer(!e.leftDrawerOpen)}}}),a("q-toolbar-title",[e._v("SilkRoad")])],1)],1),a("q-layout-drawer",{attrs:{"content-class":"mat"===e.$q.theme?"bg-grey-2":null},model:{value:e.leftDrawerOpen,callback:function(t){e.leftDrawerOpen=t},expression:"leftDrawerOpen"}},[a("map-drawer")],1),a("q-page-container",[a("router-view")],1),e.apply?a("q-page-sticky",{attrs:{position:"left",offset:[18,18]}},[a("q-btn",{attrs:{round:"",color:"primary",disable:e.$g.during["api.getTraffic"]},on:{click:function(t){e.$a("api.getTraffic",e.$f.vars.userHash.v)}}},[e.$g.during["api.getTraffic"]?a("q-spinner-pie"):a("q-icon",{attrs:{name:"mdi-check"}})],1)],1):e._e()],1)},p=[],d=a("96a1"),h=a("ce67"),b=a("525b"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-list",{attrs:{"no-border":"",link:"","inset-delimiter":""}},[a("q-inner-loading",{attrs:{visible:e.$g.during["api.getTraffic"]}},[a("div",[e._v("please wait "+e._s(e.$f.vars.processDuration.v)+" seconds")]),a("q-spinner-gears",{attrs:{size:"120px",color:"primary"}})],1),a("q-list",{attrs:{"no-border":"",link:"","inset-delimiter":"",disabled:e.$g.during["api.getTraffic"]}},[a("q-list-header",[e._v("Roads")]),a("div"),e._l(e.roads,function(t){return a("q-item",{key:t[1],attrs:{tag:"label"}},[a("q-item-side",[a("q-checkbox",{attrs:{disable:e.$g.during["api.getTraffic"]},model:{value:t[0],callback:function(a){e.$set(t,0,a)},expression:"road[0]"}})],1),a("q-item-main",[a("q-item-tile",{attrs:{label:""}},[e._v(e._s(t[2]))]),a("q-item-tile",{attrs:{sublabel:""}},[e._v(e._s(t[3]))])],1)],1)}),a("q-item-separator"),a("q-list-header",[e._v("Settings")]),e._l(e.capacity,function(t,n){return a("q-item",{key:"s"+t[2]+t[4]},[a("q-field",{attrs:{orientation:"vertical",label:t[2]},on:{click:function(t){e.resetCap()}}},[a("q-input",{staticClass:"xxx",attrs:{suffix:t[3],error:t[4],clearable:"","clear-value":t[1]},model:{value:t[0],callback:function(a){e.$set(t,0,a)},expression:"s[0]"}})],1)],1)}),a("q-item-separator")],2)],1)},m=[],g=a("b8d9"),w=a("9541"),y=a("506f"),O=a("5d8b"),I=a("79e9"),_=a("206e"),x=a("895f"),k={name:"map-drawer",components:{QSpinnerGears:x["a"],QInnerLoading:_["a"],QField:I["a"],QInput:O["a"],QItem:y["a"],QItemTile:w["a"],QItemMain:g["a"],QCheckbox:b["a"]},mapFlow:{vars:["roads","capacity"]},methods:{resetCap:function(){console.log("rest")}},watch:{roads:function(e){this.$f.vars.roadHashPart(e.map(function(e){return e[0]?1:0}).join(""))},capacity:function(e){var t=this,a=e.map(function(e){var a=parseInt(e[0]);return a||(e[4]=!0,e[0]=1,setTimeout(function(){e[4]=!1,t.$forceUpdate()},700),console.log(e),0)}).join("_");this.$f.vars.capacityHashPart(a)}},data:function(){return{goods:[[!1,"Textiles and furniture"],[!0,"Vegetables, foodstuffs and wood"],[!0,"Stone and glass"],[!0,"Minerals"],[!0,"Metals"],[!0,"Chemicals and plastics"],[!0,"Transport vehicles"],[!0,"Machinery"],[!0,"Electronics"],[!0,"Other"]]}}},D=k,j=(a("11a7"),Object(o["a"])(D,v,m,!1,null,null,null));j.options.__file="LeftDrawer.vue";var q=j.exports,L=a("482e"),M=a("eebf"),Q=a("77e2"),S=a("52b5"),R={name:"LayoutDefault",components:{QIcon:S["a"],QSpinnerPie:Q["a"],QPageSticky:M["a"],QBtn:L["a"],MapDrawer:q,QCheckbox:b["a"],QToolbarTitle:h["a"]},data:function(){return{userOpen:void 0,apply:!1}},onFlow:{"vars.userHash":function(e){this.apply=!!e},"vars.openDrawer":function(e){this.userOpen=e}},computed:{leftDrawerOpen:{get:function(){return void 0===this.userOpen?this.$q.platform.is.desktop:this.userOpen},set:function(e){this.$f.vars.openDrawer(e)}}},methods:{openURL:d["a"]}},T=R,$=(a("4dd1"),Object(o["a"])(T,l,p,!1,null,null,null));$.options.__file="Default.vue";var P=$.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("map-view",{staticClass:"mv"})},E=[],H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"maparea",attrs:{id:"map"}},[a("mapbox",{attrs:{"fullscreen-control":e.fullscreenControl,"map-options":e.mapOptions,"scale-control":e.scaleControl,"access-token":"pk.eyJ1IjoidW5xbyIsImEiOiJjam4xOWF2am4zdXFsM3ZwbndiMG8xN2czIn0.NFCL-490i2MfWkmcG5xkWw"},on:{"map-load":e.mapLoaded}})],1)},C=[],F=a("7be2"),z=a.n(F),B=(a("e192"),{name:"map-view",components:{mapbox:z.a},data:function(){return{fullscreenControl:{show:!0,position:"top-left"},mapOptions:{style:"mapbox://styles/mapbox/satellite-v9",center:[88.486052,37.830348],zoom:2},scaleControl:{show:!0,position:"top-left"}}},methods:{mapLoaded:function(e){var t={type:"FeatureCollection",features:[]};e.addSource("traffic-source",{type:"geojson",data:t}),e.addLayer({id:"traffic",source:"traffic-source",type:"line",paint:{"line-width":["get","width"],"line-color":"red"},layout:{"line-cap":"round","line-join":"round"}}),this.$f.geo.onMapFeatures.on(function(a){t.features=a,e.getSource("traffic-source").setData(t)})}}}),N=B,G=(a("5f38"),Object(o["a"])(N,H,C,!1,null,"5fcdb972",null));G.options.__file="MapView.vue";var A=G.exports,J={name:"PageHome",components:{MapView:A}},W=J,V=(a("cccb"),Object(o["a"])(W,U,E,!1,null,null,null));V.options.__file="Home.vue";var X=V.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("p",[e._v("This is an about page")])])},Z=[],K={name:"PageAbout"},ee=K,te=Object(o["a"])(ee,Y,Z,!1,null,null,null);te.options.__file="About.vue";var ae=te.exports;n["default"].use(f["a"]);var ne=new f["a"]({routes:[{path:"/",component:P,children:[{path:"",name:"home",component:X},{path:"/about",name:"about",component:ae}]}]}),re=a("c665"),se=a("a322"),oe=(a("2f62"),a("2659")),ie=a("8afe"),ce=(a("96cf"),a("3040")),ue="",fe=function(e){return console.log("API:/"+e),new Promise(function(t){return fetch(ue+e).then(function(e){return e.json().then(function(e){t(e)})})})},le={sync:function(){var e=Object(ce["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fe("/sync");case 2:if(t=e.sent,a=t.syncStamp,n=t.hash,r=t.dur,this.f.vars.processDuration(Math.round(Math.max.apply(Math,Object(ie["a"])(r)))),this.f.raw.syncStamp.v===a){e.next=13;break}return e.next=10,fe("/graph");case 10:s=e.sent,this.f.raw.graph(s),this.f.raw.syncStamp(a);case 13:return this.a.vars.init(n),e.abrupt("return",a);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getTraffic:function(){var e=Object(ce["a"])(regeneratorRuntime.mark(function e(t){var a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fe("/traffic?hash="+t);case 2:a=e.sent,n=a.traffic,this.f.vars.lastHash(t),this.a.geo.draw(n);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},pe=(a("456d"),a("ac6a"),{initGraph:function(){var e=this.f.raw.graph.v,t=e.cities,a=[],n=function(e){var a=t[e];return[a.lat,a.lon]},r={};return e.edges.forEach(function(e){var t=n(e[0]),s=n(e[1]);Math.abs(t[0]-s[0])>180&&(t[0]>0?s[0]=180-Math.abs(s[0])+180:s[0]=-180-(180-Math.abs(s[0])));var o=[t,s];a.push(o),r[e[0]+"-"+e[1]]=o,r[e[1]+"-"+e[0]]=o}),{coordinates:a,mapEdges:r}},draw:function(e){var t=this.f.geo.graph.v.mapEdges,a={},n=0;e.forEach(function(e){var t=Math.round(e[2]);n=Math.max(n,t);var r=e[0]+"-"+e[1];a[r]=t});var r=[];Object.keys(a).forEach(function(e){var s=a[e],o=s/n*100;r.push({type:"Feature",properties:{width:10*Math.sin(o*Math.PI/200),color:"#F7455D"},geometry:{type:"LineString",coordinates:t[e]}})}),this.f.geo.onMapFeatures(r)}}),de=(a("28a5"),{init:function(){var e=Object(ce["a"])(regeneratorRuntime.mark(function e(t){var a,n,r,s,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.split("-"),n=a[0],r=[[!1,"silk","New Silk Road","High speed railway"],[!1,"mongolian","Mongolian","alternative silk way"],[!1,"trans_sib","Trans-Siberian","railway"],[!1,"northeast_passage","Northeast passage","Sea route"]],r.forEach(function(e,t){return e[0]="0"!==n[t]}),s=a[1].split("_"),o=[[s[0],23,"Container capacity","kg"],[s[1],355,"Railway traffic","TEU per day"],[s[2],4346,"High-speed railway traffic","TEU per day"],[s[3],61369,"Seaborne traffic","TEU per day"],[s[4],1448,"Five Element","TEU per day"]],e.next=8,this.a.api.getTraffic(t);case 8:this.f.vars.capacity(o),this.f.vars.roads(r);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),hashPartChange:function(e){var t=this.f.vars.lastHash.v.split("-"),a=this.f.vars.roadHashPart.v,n=this.f.vars.capacityHashPart.v;a&&n&&(a!==t[0]||n!==t[1])?this.f.vars.userHash("".concat(a,"-").concat(n)):this.f.vars.userHash(!1)}}),he={getLastFeatures:function(){var e=Object(ce["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},be={api:le,geo:pe,vars:de,traffic:he},ve=function e(){Object(re["a"])(this,e),Object(se["a"])(this,"raw",{syncStamp:oe["b"].stored.get("api.sync"),graph:oe["b"].stored}),Object(se["a"])(this,"geo",{graph:oe["b"].on("raw.graph","geo.initGraph"),onMapFeatures:oe["b"].on("geo.graph","traffic.getLastFeatures")}),Object(se["a"])(this,"vars",{openDrawer:oe["b"].stored,processDuration:oe["b"],roads:oe["b"],capacity:oe["b"],lastHash:oe["b"],roadHashPart:oe["b"].action("vars.hashPartChange"),capacityHashPart:oe["b"].action("vars.hashPartChange"),userHash:oe["b"]})},me=new oe["a"](ve,be);n["default"].use(me);a("a4ac"),a("4a91");var ge=a("ebc6"),we=(a("2826"),a("b3f4"),a("e84f")),ye=a("7051"),Oe=a("2040"),Ie=a("cf12"),_e=a("32a1"),xe=a("46a9"),ke=a("f30c"),De=a("1180"),je=a("1e55"),qe=a("91c8"),Le=a("7d43");n["default"].use(we["a"],{config:{},components:{QBtn:L["a"],QLayout:ye["a"],QLayoutHeader:Oe["a"],QLayoutDrawer:Ie["a"],QPage:_e["a"],QPageContainer:xe["a"],QToolbar:ke["a"],QToolbarTitle:h["a"],QList:De["a"],QListHeader:je["a"],QItemSeparator:qe["a"],QItem:y["a"],QItemSide:Le["a"],QItemMain:g["a"]},directives:{},plugins:{},iconSet:ge["a"]}),n["default"].config.productionTip=!1,new n["default"]({router:ne,store:void 0,render:function(e){return e(u)}}).$mount("#app")},"57c1":function(e,t,a){},"5f38":function(e,t,a){"use strict";var n=a("2c71"),r=a.n(n);r.a},"8f59":function(e,t,a){},"97cb":function(e,t,a){var n={"./bounce.css":"3d49","./bounceIn.css":"0a58","./bounceInDown.css":"a4a9","./bounceInLeft.css":"5965","./bounceInRight.css":"da80","./bounceInUp.css":"b60e","./bounceOut.css":"f39d","./bounceOutDown.css":"a9b5","./bounceOutLeft.css":"06dd","./bounceOutRight.css":"66bc","./bounceOutUp.css":"908f","./fadeIn.css":"1070","./fadeInDown.css":"1625","./fadeInDownBig.css":"9338","./fadeInLeft.css":"0c2e","./fadeInLeftBig.css":"f357","./fadeInRight.css":"ef8f","./fadeInRightBig.css":"747a","./fadeInUp.css":"e7fb","./fadeInUpBig.css":"b8af","./fadeOut.css":"25cd","./fadeOutDown.css":"93ea","./fadeOutDownBig.css":"c888","./fadeOutLeft.css":"5f1d","./fadeOutLeftBig.css":"a555","./fadeOutRight.css":"8934","./fadeOutRightBig.css":"9438","./fadeOutUp.css":"351b","./fadeOutUpBig.css":"23a5","./flash.css":"58a5","./flip.css":"bda0","./flipInX.css":"58b8","./flipInY.css":"5902","./flipOutX.css":"72c5","./flipOutY.css":"b8ad","./headShake.css":"2289","./hinge.css":"085e","./jello.css":"8014","./lightSpeedIn.css":"eb7d","./lightSpeedOut.css":"d043","./pulse.css":"ab98","./rollIn.css":"dc73","./rollOut.css":"592c","./rotateIn.css":"487d","./rotateInDownLeft.css":"bf6b","./rotateInDownRight.css":"7b96","./rotateInUpLeft.css":"89f8","./rotateInUpRight.css":"cb8c","./rotateOut.css":"de65","./rotateOutDownLeft.css":"8134","./rotateOutDownRight.css":"1ea7","./rotateOutUpLeft.css":"63d1","./rotateOutUpRight.css":"fcc3","./rubberBand.css":"aab2","./shake.css":"15f1","./slideInDown.css":"79ea","./slideInLeft.css":"a963","./slideInRight.css":"3b76","./slideInUp.css":"21e3","./slideOutDown.css":"abed","./slideOutLeft.css":"f857","./slideOutRight.css":"0a43","./slideOutUp.css":"5706","./swing.css":"b968","./tada.css":"3391","./wobble.css":"ed5b","./zoomIn.css":"38f3","./zoomInDown.css":"2577","./zoomInLeft.css":"1992","./zoomInRight.css":"ef68","./zoomInUp.css":"97a1","./zoomOut.css":"cc15","./zoomOutDown.css":"2ac6","./zoomOutLeft.css":"1fd4","./zoomOutRight.css":"fa2f","./zoomOutUp.css":"91e5"};function r(e){var t=s(e);return a(t)}function s(e){var t=n[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id="97cb"},a4ac:function(e,t,a){},c21b:function(e,t,a){},cccb:function(e,t,a){"use strict";var n=a("8f59"),r=a.n(n);r.a}});
//# sourceMappingURL=app.623689e9.js.map